{% extends 'base.html' %}

{% load humanize %}

{% block content %}
{% load static %}
{% if product %}
  {% for p in product %}
  <section style="background-color : #222222" class="py-5 text-white">
      <div class="container">
        <div class="row text-center">
          <div class="col-md-12">
            <h1 class="display-4">{{ p.title }}</h1>
  <!--          <p class="lead">-->
  <!--            <i class="fas fa-map-marker"></i></p>-->
          </div>
        </div>
      </div>
    </section>

    <!-- Breadcrumb -->
    <section id="bc" class="mt-3">
      <div class="container">
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item">
              <a href="{%url 'index' %}" style="color:black;">Home</a>
            </li>
  <!--          <li class="breadcrumb-item">-->
  <!--            <a href="" style="color:black;">Products</a>-->
  <!--          </li>-->
            <li class="breadcrumb-item active">{{p.title}}</li>
          </ol>
        </nav>
      </div>
    </section>

    <!-- Listing -->
    <section id="listing" class="py-4">
      <div class="container">
        <div class="row">
          <div style="width:75%; margin:auto">
            <!-- Home Main Image -->
            <img src="{{p.photo_main.url}}" alt="" class="img-main img-fluid mb-3">
            <!-- Thumbnails -->
            <div class="row mb-5 thumbs">
              <div class="col-md-2">
                <a href="{{p.photo_2.url}}" data-lightbox="home-images">
                  <img src="{{p.photo_2.url}}" alt="" class="img-fluid">
                </a>
              </div>
              <div class="col-md-2">
                <a href="{{p.photo_3.url}}" data-lightbox="home-images">
                  <img src="{{p.photo_3.url}}" alt="" class="img-fluid">
                </a>
              </div>
              <div class="col-md-2">
                <a href="{{p.photo_3.url}}" data-lightbox="home-images">
                  <img src="{{p.photo_3.url}}" alt="" class="img-fluid">
                </a>
              </div>
              <div class="col-md-2">
                <a href="{{p.photo_main.url}}" data-lightbox="home-images">
                  <img src="{{p.photo_main.url}}" alt="" class="img-fluid">
                </a>
              </div>
              <div class="col-md-2">
                <a href="{{p.photo_main.url}}" data-lightbox="home-images">
                  <img src="{{p.photo_main.url}}" alt="" class="img-fluid">
                </a>
              </div>
              <div class="col-md-2">
                <a href="" data-lightbox="home-images">
                  <img src="{{p.photo_main.url}}" alt="" class="img-fluid">
                </a>
              </div>
            </div>

            <!-- Fields -->
            <div class="row mb-5 fields" style="width:100%">
              <div style="width:100%">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item ">
                    <i class="fas fa-list-alt"></i> Category:
                    <span class="float-right">{{ p.category }}</span>
                  </li>
                  <li class="list-group-item ">
                    <i class="fa fa-money-bill-alt"></i> Price:
                    <span class="float-right">
                      {% if p.currency == 'usd' %}
                           ${{ p.price }}
                           {% else %}
                           L.L{{ p.price }}
                           {% endif%}
                    </span>
                  </li>
                  <li class="list-group-item">
                    <i class="fa fa-sort-amount-asc"></i> Brand:
                    <span class="float-right">{{ p.brand_name }}</span>
                  </li>
                  <li class="list-group-item ">
                    <i class="fas fa-store-alt"></i> In Stock:
                    <span class="float-right">
                      {% if p.in_stock %}
                           Yes
                           {% else %}
                           No
                           {% endif %}
                    </span>
                  </li>
                </ul>
              </div>

              <div class="row" style="margin-left:15px; margin-top:20px;">
                     <a data-product="{{product.id}}" data-action="remove" class="fas fa-minus chg-quantity update-cart btn" style="background-color:#333; color:white; width:40px; height:30px;"></a>
                     <p>
                        <input class="input-group-field quantity" type="number" name="quantity"  style="height:30px; margin-top:5px; margin-right:0px; margin-left:0px; width:50px;">
                     </p>
                     <a data-product= "{{product.id}}" data-action="add" class="fas fa-plus chg-quantity update-cart btn" style=" background-color:#333; color:white; width:40px; height:30px;"></a>
                  </div>


            <!-- Description -->

        <div class="container">
            <div class="row mb-5">
              <div class="col-md-12">
                <h3>Product Description</h3>
                {{ p.description }}
              </div>
            </div>
        </div>


            <!--Review-->
            <div class="container">
            <div class="row mb-5">
              <div class="col-md-12">
                <h3>Review</h3>
                <form>
                  <textarea style="background-color:white"></textarea>
                  <ul class="rating">
                    <li class="rating-item active" data-rate="1"></li>
                    <li class="rating-item" data-rate="2"></li>
                    <li class="rating-item" data-rate="3"></li>
                    <li class="rating-item" data-rate="4"></li>
                    <li class="rating-item" data-rate="5"></li>
                  </ul>
                  <button class = "btn btn-light " style="background-color: #2a2a2a; color:white; margin-top:5px;" type="button" id="custom-button">Submit</button>


                </form>

              </div>

            </div>
              </div>
          </div>
        </div>
      </div>

    </div>
      </section>

{% endfor %}
{% endif %}

<script>
  const container = document.querySelector('.rating');
   const items = container.querySelectorAll('.rating-item')
   container.onclick = e => {
   const elClass = e.target.classList;
   // change the rating if the user clicks on a different star
   if (!elClass.contains('active')) {
   items.forEach( // reset the active class on the star
   item => item.classList.remove('active')
   );
   console.log(e.target.getAttribute("data-rate"));
   elClass.add('active'); // add active class to the clicked star
   }
   };
</script>





<style>
.checked {
  color: orange;
}

.rating {
display: flex;
padding: 0;
margin: 0;
}

.rating li {
list-style-type: none
}

.rating-item {
border: 1px solid #fff;
cursor: pointer;
font-size:2em;
color: orange;
}

/* initial: make all stars full */
.rating-item::before {
content: "\2605";
}

/* make until the clicked star (the rest) empty */
.rating-item.active ~ .rating-item::before {
content: "\2606";
}

/* on hover make all full */
.rating:hover .rating-item::before {
content: "\2605";
}

/* make until the hovered (the rest) empty */
.rating-item:hover ~ .rating-item::before {
content: "\2606";
}

textarea {
  width: 100%;
  height: 150px;
  padding: 5px 10px;
  box-sizing: border-box;
  border: 2px solid #ccc;
  border-radius: 4px;
  background-color: #f8f8f8;
  resize: none;
}
.show-cart li {
  display: flex;
}
.card {
  margin-bottom: 20px;
}
.card-img-top {
  width: 200px;
  height: 200px;
  align-self: center;
}

</style>

<!--function updateUserOrder(productId, action){-->
<!--    console.log('User is logged in, sending data..')-->

<!--    var url ='update_item'-->

<!--    fetch(url, {-->
<!--        method:'POST',-->
<!--        headers:{-->
<!--            'Content-Type':'application/json',-->
<!--            'X-CSRFToken':csrftoken,-->
<!--        },-->
<!--        body:JSON.stringify({'productId':productId, 'action':action})-->
<!--    })-->

<!--    .then((response) =>{-->
<!--        return response.json()-->
<!--    })-->

<!--    .then((data) =>{-->
<!--        console.log('data',data)-->
<!--        location.reload()-->
<!--    })-->

<!--}-->



{% endblock %}